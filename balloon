const balloons = [];
const balloonRadius = 50;
const balloonSpeed = 2;
const balloonColor = 'red';

// Load the background image
const backgroundImage = new Image();
backgroundImage.src = './img/3.jpg';
backgroundImage.onload = function () {
    // Start the game loop after the image has loaded
    gameLoop();
};

// Set up an event listener for keydown events
document.addEventListener('keydown', handleKeyDown);

// Define the keydown event handler
function handleKeyDown(event) {
    // Check if the key matches the balloon's corresponding letter
    const key = event.key.toLowerCase();
    const index = balloons.findIndex(balloon => !balloon.isBlasted && balloon.letter === key);
    if (index !== -1) {
        burstBalloon(index);
    }

}

// Define a function to create a new balloon
function createBalloon() {
    const balloon = {
        x: Math.random() * (canvas.width - 2 * balloonRadius) + balloonRadius,
        y: canvas.height,
        radius: balloonRadius,
        color: balloonColor,
        letter: getRandomLetter(),
        isBlasted: false
    };
    balloons.push(balloon);
}

// Define a function to generate a random letter
function getRandomLetter() {
    const alphabet = 'abcdefghijklmnopqrstuvwxyz';
    return alphabet[Math.floor(Math.random() * alphabet.length)];
}

// Define a function to burst a balloon
function burstBalloon(index) {
    balloons[index].isBlasted = true;
}

// Define the game loop function
function gameLoop() {
    // Render the background image
    ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);

    // Create a new balloon randomly
    if (Math.random() < 0.01) {
        createBalloon();
    }

    // Update and render all balloons
    for (let i = 0; i < balloons.length; i++) {
        const balloon = balloons[i];

        // Move the balloon upwards
        balloon.y -= balloonSpeed;

        // Check if the balloon is out of the canvas or blasted
        if (balloon.y + balloon.radius < 0 || balloon.isBlasted) {

            balloons.splice(i, 1); // Remove the balloon from the array
            i--; // Adjust the index since the array length has decreased
            continue;

        }

        // Render the balloon
        ctx.fillStyle = balloon.color;
        ctx.beginPath();
        ctx.arc(balloon.x, balloon.y, balloon.radius, 0, 2 * Math.PI);
        ctx.fill();

        // Render the balloon's letter inside it
        ctx.font = "65px Comic Sans MS";
        ctx.fillStyle = "#ffffff"; // White color
        ctx.lineWidth = 15;
        ctx.strokeStyle = "#000000"; // Black color
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(balloon.letter.toUpperCase(), balloon.x, balloon.y);
    }

    // Call the game loop on the next animation frame
    requestAnimationFrame(gameLoop);


}

